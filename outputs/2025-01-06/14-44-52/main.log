[2025-01-06 14:44:52,523][flwr][WARNING] - 
Setting `min_available_clients` lower than `min_fit_clients` or
`min_evaluate_clients` can cause the server to fail when there are too few clients
connected to the server. `min_available_clients` must be set to a value larger
than or equal to the values of `min_fit_clients` and `min_evaluate_clients`.

[2025-01-06 14:44:52,524][flwr][WARNING] - DEPRECATED FEATURE: flwr.simulation.start_simulation() is deprecated.
	Instead, use the `flwr run` CLI command to start a local simulation in your Flower app, as shown for example below:

		$ flwr new  # Create a new Flower app from a template

		$ flwr run  # Run the Flower app in Simulation Mode

	Using `start_simulation()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[2025-01-06 14:44:52,529][flwr][INFO] - Starting Flower simulation, config: num_rounds=5, no round_timeout
[2025-01-06 14:44:56,342][flwr][INFO] - Flower VCE: Ray initialized with resources: {'accelerator_type:G': 1.0, 'memory': 1051697972.0, 'object_store_memory': 525848985.0, 'CPU': 12.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'node:127.0.0.1': 1.0}
[2025-01-06 14:44:56,343][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2025-01-06 14:44:56,343][flwr][INFO] - No `client_resources` specified. Using minimal resources for clients.
[2025-01-06 14:44:56,344][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 0.0}
[2025-01-06 14:44:56,357][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 12 actors
[2025-01-06 14:44:56,357][flwr][INFO] - [INIT]
[2025-01-06 14:44:56,358][flwr][INFO] - Requesting initial parameters from one random client
[2025-01-06 14:45:05,614][flwr][INFO] - Received initial parameters from one random client
[2025-01-06 14:45:05,615][flwr][INFO] - Starting evaluation of initial global parameters
[2025-01-06 14:45:14,101][flwr][INFO] - initial parameters (loss, other metrics): 1151.6666116714478, {'accuracy': 0.09808333333333333}
[2025-01-06 14:45:14,101][flwr][INFO] - 
[2025-01-06 14:45:14,102][flwr][INFO] - [ROUND 1]
[2025-01-06 14:45:14,104][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 10)
[2025-01-06 14:45:35,416][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 30, in train
    net.to(device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 1340, in to
    return self._apply(convert)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 900, in _apply
    module._apply(fn)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 927, in _apply
    param_applied = fn(param)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 1326, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[2025-01-06 14:45:36,364][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 30, in train
    net.to(device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 1340, in to
    return self._apply(convert)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 900, in _apply
    module._apply(fn)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 927, in _apply
    param_applied = fn(param)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\nn\modules\module.py", line 1326, in convert
    return t.to(
RuntimeError: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA error: CUDA-capable device(s) is/are busy or unavailable
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
[2025-01-06 14:46:10,762][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: 
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 523, in <module>
    abs = _make_elementwise_unary_prim(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 491, in _make_elementwise_unary_prim
    return _make_prim(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 319, in _make_prim
    prim_def = torch.library.custom_op(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 157, in custom_op
    return inner(fn)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 138, in inner
    result = CustomOpDef(namespace, opname, schema_str, fn)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 186, in __init__
    self._register_to_dispatcher()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 616, in _register_to_dispatcher
    lib._register_fake(self._name, fake_impl, _stacklevel=4)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 163, in _register_fake
    source = torch._library.utils.get_source(_stacklevel + 1)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\utils.py", line 42, in get_source
    frame = inspect.getframeinfo(sys._getframe(stacklevel))
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\inspect.py", line 1505, in getframeinfo
    lines, lnum = findsource(frame)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\inspect.py", line 829, in findsource
    module = getmodule(object, file)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\inspect.py", line 754, in getmodule
    modulesbyfile[f] = modulesbyfile[
MemoryError

[2025-01-06 14:46:11,048][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: 
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 523, in <module>
    abs = _make_elementwise_unary_prim(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 491, in _make_elementwise_unary_prim
    return _make_prim(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 319, in _make_prim
    prim_def = torch.library.custom_op(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 157, in custom_op
    return inner(fn)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 138, in inner
    result = CustomOpDef(namespace, opname, schema_str, fn)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 186, in __init__
    self._register_to_dispatcher()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\custom_ops.py", line 616, in _register_to_dispatcher
    lib._register_fake(self._name, fake_impl, _stacklevel=4)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 163, in _register_fake
    source = torch._library.utils.get_source(_stacklevel + 1)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_library\utils.py", line 42, in get_source
    frame = inspect.getframeinfo(sys._getframe(stacklevel))
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\inspect.py", line 1505, in getframeinfo
    lines, lnum = findsource(frame)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\inspect.py", line 829, in findsource
    module = getmodule(object, file)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\inspect.py", line 754, in getmodule
    modulesbyfile[f] = modulesbyfile[
MemoryError
[2025-01-06 14:46:12,644][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 6344, 20444) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 6344, 20444) exited unexpectedly

[2025-01-06 14:46:12,655][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 6344, 20444) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 6344, 20444) exited unexpectedly
[2025-01-06 14:46:13,157][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 5800, 5664) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 5800, 5664) exited unexpectedly

[2025-01-06 14:46:13,167][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 5800, 5664) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 5800, 5664) exited unexpectedly
[2025-01-06 14:46:13,179][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 11056, 1484) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 11056, 1484) exited unexpectedly

[2025-01-06 14:46:13,188][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 11056, 1484) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 11056, 1484) exited unexpectedly
[2025-01-06 14:46:13,194][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 8968, 17488) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 8968, 17488) exited unexpectedly

[2025-01-06 14:46:13,204][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 8968, 17488) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 8968, 17488) exited unexpectedly
[2025-01-06 14:46:13,221][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 9436, 3884) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 9436, 3884) exited unexpectedly

[2025-01-06 14:46:13,229][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 9436, 3884) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 9436, 3884) exited unexpectedly
[2025-01-06 14:46:13,243][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 24256, 8608) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 24256, 8608) exited unexpectedly

[2025-01-06 14:46:13,252][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 24256, 8608) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 24256, 8608) exited unexpectedly
[2025-01-06 14:46:22,519][flwr][INFO] - aggregate_fit: received 2 results and 8 failures
[2025-01-06 14:46:22,532][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2025-01-06 14:46:33,155][flwr][INFO] - fit progress: (1, 466.90239161252975, {'accuracy': 0.8538666666666667}, 79.0534329)
[2025-01-06 14:46:33,156][flwr][INFO] - Sampling failed: number of available clients (10) is less than number of requested clients (25).
[2025-01-06 14:46:33,156][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2025-01-06 14:46:33,157][flwr][INFO] - 
[2025-01-06 14:46:33,157][flwr][INFO] - [ROUND 2]
[2025-01-06 14:46:33,158][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 10)
[2025-01-06 14:47:36,393][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\context.py", line 327, in _Popen
    return Popen(process_obj)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\multiprocessing\reductions.py", line 607, in reduce_storage
    metadata = storage._share_filename_cpu_()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 437, in wrapper
    return fn(self, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 516, in _share_filename_cpu_
    return super()._share_filename_cpu_(*args, **kwargs)
RuntimeError: Couldn't open shared file mapping: <torch_11192_1359495913_2>, error code: <1455>

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Couldn't open shared file mapping: <torch_11192_1359495913_2>, error code: <1455>

[2025-01-06 14:47:36,423][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1138, in __init__
    w.start()
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\context.py", line 327, in _Popen
    return Popen(process_obj)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\popen_spawn_win32.py", line 93, in __init__
    reduction.dump(process_obj, to_child)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\multiprocessing\reductions.py", line 607, in reduce_storage
    metadata = storage._share_filename_cpu_()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 437, in wrapper
    return fn(self, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 516, in _share_filename_cpu_
    return super()._share_filename_cpu_(*args, **kwargs)
RuntimeError: Couldn't open shared file mapping: <torch_11192_1359495913_2>, error code: <1455>

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Couldn't open shared file mapping: <torch_11192_1359495913_2>, error code: <1455>
[2025-01-06 14:47:40,635][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=21988, ip=127.0.0.1, actor_id=9c07f8356cad0f54fde87b7b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002756DD14460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: [WinError 1455] The paging file is too small for this operation to complete. Error loading "D:\federated Parkinsons\.venv\lib\site-packages\torch\lib\cufft64_10.dll" or one of its dependencies.
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 262, in <module>
    _load_dll_libraries()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 245, in _load_dll_libraries
    raise err
OSError: [WinError 1455] The paging file is too small for this operation to complete. Error loading "D:\federated Parkinsons\.venv\lib\site-packages\torch\lib\cufft64_10.dll" or one of its dependencies.

[2025-01-06 14:47:40,663][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=21988, ip=127.0.0.1, actor_id=9c07f8356cad0f54fde87b7b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002756DD14460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: [WinError 1455] The paging file is too small for this operation to complete. Error loading "D:\federated Parkinsons\.venv\lib\site-packages\torch\lib\cufft64_10.dll" or one of its dependencies.
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 262, in <module>
    _load_dll_libraries()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 245, in _load_dll_libraries
    raise err
OSError: [WinError 1455] The paging file is too small for this operation to complete. Error loading "D:\federated Parkinsons\.venv\lib\site-packages\torch\lib\cufft64_10.dll" or one of its dependencies.
[2025-01-06 14:47:42,095][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228

[2025-01-06 14:47:42,106][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
[2025-01-06 14:47:45,036][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 21488, 9432) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 21488, 9432) exited unexpectedly

[2025-01-06 14:47:45,179][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 21488, 9432) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=14092, ip=127.0.0.1, actor_id=d655532cd942aa416d89e10801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000025238424460>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 21488, 9432) exited unexpectedly
[2025-01-06 14:47:48,082][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 7796) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 7796) exited unexpectedly

[2025-01-06 14:47:48,174][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 7796) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 7796) exited unexpectedly
[2025-01-06 14:47:54,108][flwr][INFO] - aggregate_fit: received 5 results and 5 failures
[2025-01-06 14:48:07,195][flwr][INFO] - fit progress: (2, 121.0887781791389, {'accuracy': 0.9534833333333333}, 173.0938933)
[2025-01-06 14:48:07,196][flwr][INFO] - Sampling failed: number of available clients (10) is less than number of requested clients (25).
[2025-01-06 14:48:07,196][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2025-01-06 14:48:07,197][flwr][INFO] - 
[2025-01-06 14:48:07,197][flwr][INFO] - [ROUND 3]
[2025-01-06 14:48:07,198][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 10)
[2025-01-06 14:48:59,371][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228

[2025-01-06 14:48:59,388][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
[2025-01-06 14:49:00,912][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 12492, 3448) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 12492, 3448) exited unexpectedly

[2025-01-06 14:49:00,914][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 1344, 22728) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 1344, 22728) exited unexpectedly

[2025-01-06 14:49:00,916][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 11524, 5808) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 11524, 5808) exited unexpectedly

[2025-01-06 14:49:00,925][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 12492, 3448) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 12492, 3448) exited unexpectedly
[2025-01-06 14:49:00,954][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 1344, 22728) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=17412, ip=127.0.0.1, actor_id=57be239b4b31f3a7f2ffa8f301000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000016F731644C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 1344, 22728) exited unexpectedly
[2025-01-06 14:49:00,959][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 11524, 5808) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 11524, 5808) exited unexpectedly
[2025-01-06 14:49:00,967][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228

[2025-01-06 14:49:00,995][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
[2025-01-06 14:49:01,763][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=21988, ip=127.0.0.1, actor_id=9c07f8356cad0f54fde87b7b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002756DD14460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2475, in <module>
    from torch import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\__init__.py", line 64, in <module>
    from .dynamic_shapes import Constraint, Dim, dims, ShapesCollection
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\dynamic_shapes.py", line 23, in <module>
    from .exported_program import ExportedProgram
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\exported_program.py", line 26, in <module>
    from torch._higher_order_ops.utils import autograd_not_implemented
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\__init__.py", line 1, in <module>
    from torch._higher_order_ops.cond import cond
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\cond.py", line 6, in <module>
    import torch._subclasses.functional_tensor
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_subclasses\functional_tensor.py", line 9, in <module>
    import torch._inductor.config as inductor_config
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 44, in <module>
    os.environ.get("TORCHINDUCTOR_FX_GRAPH_CACHE", "0" if is_fbcode() else "1") == "1"
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 9, in is_fbcode
    return not hasattr(torch.version, "git_version")
AttributeError: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)

[2025-01-06 14:49:01,771][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=21988, ip=127.0.0.1, actor_id=9c07f8356cad0f54fde87b7b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002756DD14460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2475, in <module>
    from torch import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\__init__.py", line 64, in <module>
    from .dynamic_shapes import Constraint, Dim, dims, ShapesCollection
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\dynamic_shapes.py", line 23, in <module>
    from .exported_program import ExportedProgram
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\exported_program.py", line 26, in <module>
    from torch._higher_order_ops.utils import autograd_not_implemented
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\__init__.py", line 1, in <module>
    from torch._higher_order_ops.cond import cond
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\cond.py", line 6, in <module>
    import torch._subclasses.functional_tensor
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_subclasses\functional_tensor.py", line 9, in <module>
    import torch._inductor.config as inductor_config
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 44, in <module>
    os.environ.get("TORCHINDUCTOR_FX_GRAPH_CACHE", "0" if is_fbcode() else "1") == "1"
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 9, in is_fbcode
    return not hasattr(torch.version, "git_version")
AttributeError: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)
[2025-01-06 14:49:04,279][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 18928, 23292) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 18928, 23292) exited unexpectedly

[2025-01-06 14:49:04,291][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 18928, 23292) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 18928, 23292) exited unexpectedly
[2025-01-06 14:49:05,366][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 18700, 15108) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 18700, 15108) exited unexpectedly

[2025-01-06 14:49:05,374][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 18700, 15108) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 18700, 15108) exited unexpectedly
[2025-01-06 14:49:05,403][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 24228, 18176) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 24228, 18176) exited unexpectedly

[2025-01-06 14:49:05,413][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 24228, 18176) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 24228, 18176) exited unexpectedly
[2025-01-06 14:49:14,059][flwr][INFO] - aggregate_fit: received 1 results and 9 failures
[2025-01-06 14:49:24,977][flwr][INFO] - fit progress: (3, 123.67511166166514, {'accuracy': 0.9383166666666667}, 250.87555919999997)
[2025-01-06 14:49:24,978][flwr][INFO] - Sampling failed: number of available clients (10) is less than number of requested clients (25).
[2025-01-06 14:49:24,979][flwr][INFO] - configure_evaluate: no clients selected, skipping evaluation
[2025-01-06 14:49:24,979][flwr][INFO] - 
[2025-01-06 14:49:24,979][flwr][INFO] - [ROUND 4]
[2025-01-06 14:49:24,980][flwr][INFO] - configure_fit: strategy sampled 10 clients (out of 10)
[2025-01-06 14:51:32,092][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=21988, ip=127.0.0.1, actor_id=9c07f8356cad0f54fde87b7b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002756DD14460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2475, in <module>
    from torch import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\__init__.py", line 64, in <module>
    from .dynamic_shapes import Constraint, Dim, dims, ShapesCollection
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\dynamic_shapes.py", line 23, in <module>
    from .exported_program import ExportedProgram
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\exported_program.py", line 26, in <module>
    from torch._higher_order_ops.utils import autograd_not_implemented
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\__init__.py", line 1, in <module>
    from torch._higher_order_ops.cond import cond
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\cond.py", line 6, in <module>
    import torch._subclasses.functional_tensor
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_subclasses\functional_tensor.py", line 9, in <module>
    import torch._inductor.config as inductor_config
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 44, in <module>
    os.environ.get("TORCHINDUCTOR_FX_GRAPH_CACHE", "0" if is_fbcode() else "1") == "1"
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 9, in is_fbcode
    return not hasattr(torch.version, "git_version")
AttributeError: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)

[2025-01-06 14:51:32,104][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228

[2025-01-06 14:51:32,104][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Unable to allocate internal buffer.
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 269, in _deserialize_msgpack_data
    msgpack_data, pickle5_data = split_buffer(data)
  File "python\ray\includes/serialization.pxi", line 206, in ray._raylet.split_buffer
  File "msgpack\\_unpacker.pyx", line 372, in msgpack._cmsgpack.Unpacker.__init__
MemoryError: Unable to allocate internal buffer.

[2025-01-06 14:51:32,109][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=21988, ip=127.0.0.1, actor_id=9c07f8356cad0f54fde87b7b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000002756DD14460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2475, in <module>
    from torch import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\__init__.py", line 64, in <module>
    from .dynamic_shapes import Constraint, Dim, dims, ShapesCollection
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\dynamic_shapes.py", line 23, in <module>
    from .exported_program import ExportedProgram
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\export\exported_program.py", line 26, in <module>
    from torch._higher_order_ops.utils import autograd_not_implemented
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\__init__.py", line 1, in <module>
    from torch._higher_order_ops.cond import cond
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_higher_order_ops\cond.py", line 6, in <module>
    import torch._subclasses.functional_tensor
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_subclasses\functional_tensor.py", line 9, in <module>
    import torch._inductor.config as inductor_config
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 44, in <module>
    os.environ.get("TORCHINDUCTOR_FX_GRAPH_CACHE", "0" if is_fbcode() else "1") == "1"
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_inductor\config.py", line 9, in is_fbcode
    return not hasattr(torch.version, "git_version")
AttributeError: partially initialized module 'torch' has no attribute 'version' (most likely due to a circular import)
[2025-01-06 14:51:32,125][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23172, ip=127.0.0.1, actor_id=8119818e4171a885acbadab401000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000023076E04460>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 272, in _deserialize_msgpack_data
    python_objects = self._deserialize_pickle5_data(pickle5_data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 262, in _deserialize_pickle5_data
    obj = pickle.loads(in_band)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\__init__.py", line 2486, in <module>
    from torch import _meta_registrations
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_meta_registrations.py", line 10, in <module>
    from torch._decomp import (
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\__init__.py", line 249, in <module>
    import torch._decomp.decompositions
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_decomp\decompositions.py", line 15, in <module>
    import torch._prims as prims
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_prims\__init__.py", line 36, in <module>
    prim = torch.library.Library("prims", "DEF")
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\library.py", line 87, in __init__
    self.m: Optional[Any] = torch._C._dispatch_library(
RuntimeError: Only a single TORCH_LIBRARY can be used to register the namespace prims; please put all of your definitions in a single TORCH_LIBRARY block.  If you were trying to specify implementations, consider using TORCH_LIBRARY_IMPL (which can be duplicated).  If you really intended to define operators for a single namespace in a distributed way, you can use TORCH_LIBRARY_FRAGMENT to explicitly indicate this.  Previous registration of TORCH_LIBRARY was registered at /dev/null:228; latest registration was registered at /dev/null:228
[2025-01-06 14:51:32,128][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=18872, ip=127.0.0.1, actor_id=e221fd42b1f4844116111dac01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D102C54400>)
  File "python\ray\_raylet.pyx", line 1826, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1860, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 963, in ray._raylet.raise_if_dependency_failed
ray.exceptions.RaySystemError: System error: Unable to allocate internal buffer.
traceback: Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 460, in deserialize_objects
    obj = self._deserialize_object(data, metadata, object_ref)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 317, in _deserialize_object
    return self._deserialize_msgpack_data(data, metadata_fields)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\serialization.py", line 269, in _deserialize_msgpack_data
    msgpack_data, pickle5_data = split_buffer(data)
  File "python\ray\includes/serialization.pxi", line 206, in ray._raylet.split_buffer
  File "msgpack\\_unpacker.pyx", line 372, in msgpack._cmsgpack.Unpacker.__init__
MemoryError: Unable to allocate internal buffer.
[2025-01-06 14:51:38,015][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1465, in _next_data
    return self._process_data(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1491, in _process_data
    data.reraise()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_utils.py", line 715, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_24464_681512245_454>, error code: <1455>


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught RuntimeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_24464_681512245_454>, error code: <1455>

[2025-01-06 14:51:38,033][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1465, in _next_data
    return self._process_data(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1491, in _process_data
    data.reraise()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_utils.py", line 715, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_24464_681512245_454>, error code: <1455>


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=23164, ip=127.0.0.1, actor_id=d3c911225bd277b637aeb31c01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x0000017C33D044C0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught RuntimeError in DataLoader worker process 1.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_24464_681512245_454>, error code: <1455>
[2025-01-06 14:51:38,040][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1465, in _next_data
    return self._process_data(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1491, in _process_data
    data.reraise()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_utils.py", line 715, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_21520_3135607248_624>, error code: <1455>


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_21520_3135607248_624>, error code: <1455>

[2025-01-06 14:51:38,063][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1465, in _next_data
    return self._process_data(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1491, in _process_data
    data.reraise()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\_utils.py", line 715, in reraise
    raise exception
RuntimeError: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_21520_3135607248_624>, error code: <1455>


The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11696, ip=127.0.0.1, actor_id=9058a981122e1407c115c37601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x00000244F9B214F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 211, in collate
    return [
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 212, in <listcomp>
    collate(samples, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\_utils\collate.py", line 270, in collate_tensor_fn
    storage = elem._typed_storage()._new_shared(numel, device=elem.device)
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 1180, in _new_shared
    untyped_storage = torch.UntypedStorage._new_shared(
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\storage.py", line 400, in _new_shared
    return cls._new_using_filename_cpu(size)
RuntimeError: Couldn't open shared file mapping: <torch_21520_3135607248_624>, error code: <1455>
[2025-01-06 14:51:39,005][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 24240) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 24240) exited unexpectedly

[2025-01-06 14:51:39,015][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 24240) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=19452, ip=127.0.0.1, actor_id=c515bc849658a496c18b58e201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001F0AA5D4430>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 24240) exited unexpectedly
[2025-01-06 14:51:41,261][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 23944) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 23944) exited unexpectedly

[2025-01-06 14:51:41,269][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 23944) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=12516, ip=127.0.0.1, actor_id=628a5008708558d7294e79bf01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001D6736914F0>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 23944) exited unexpectedly
[2025-01-06 14:51:41,822][flwr][ERROR] - Traceback (most recent call last):
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 2755, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\worker.py", line 906, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 13420, 8816) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 13420, 8816) exited unexpectedly

[2025-01-06 14:51:41,828][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "C:\Users\Admin\AppData\Local\Programs\Python\Python39\lib\multiprocessing\queues.py", line 114, in get
    raise Empty
_queue.Empty

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 58, in run
    out_message = app(message=message, context=context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 143, in __call__
    return self._call(message, context)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\message_handler\message_handler.py", line 128, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\client.py", line 224, in maybe_call_fit
    return client.fit(fit_ins)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\client\numpy_client.py", line 227, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "D:\federated Parkinsons\client.py", line 59, in fit
    train(self.model, self.trainloader, optim, epochs, self.device)
  File "D:\federated Parkinsons\model.py", line 32, in train
    for images, labels in trainloader:
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1448, in _next_data
    idx, data = self._get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1412, in _get_data
    success, data = self._try_get_data()
  File "D:\federated Parkinsons\.venv\lib\site-packages\torch\utils\data\dataloader.py", line 1256, in _try_get_data
    raise RuntimeError(
RuntimeError: DataLoader worker (pid(s) 13420, 8816) exited unexpectedly

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=11192, ip=127.0.0.1, actor_id=ec506f83f434797d44faad5801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x000001E9DE5B4490>)
  File "python\ray\_raylet.pyx", line 1873, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1974, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1879, in ray._raylet.execute_task
  File "python\ray\_raylet.pyx", line 1820, in ray._raylet.execute_task.function_executor
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\_private\function_manager.py", line 696, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\ray\util\tracing\tracing_helper.py", line 467, in _resume_span
    return method(self, *_args, **_kwargs)
  File "D:\federated Parkinsons\.venv\lib\site-packages\flwr\simulation\ray_transport\ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: DataLoader worker (pid(s) 13420, 8816) exited unexpectedly
